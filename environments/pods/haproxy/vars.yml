---
pods:
  - name: haproxy
    dockerfile: True
    image: registry.access.redhat.com/ubi8/ubi-init:8.3
    docker:
      run:
        - yum install -y haproxy
        - systemctl enable haproxy
      expose: 8443 8080 8929 1936
      cmd: /sbin/init
    ports:
      - "8080:8080"
      - "8443:8443"
      - "8929:8929"
      - "1936:1936"
    volumes:
      templates:
        - src: haproxy.cfg.j2
          dest: /etc/haproxy/

    systemd:
      # Space separated list of wants
      wants_services: network.target bind9-pod.service gitlab-pod.service
      # Space separated list of after services
      after_services: network-online.target bind9-pod.service gitlab-pod.service
      state: started
      enabled: true

# Pod volumes
volumes:
  - /etc/haproxy
  - /etc/ssl/certs
# Pod dockerfile if required along with pod-compose file

letsencrypt_cert_dirs: /etc/ssl/certs/
